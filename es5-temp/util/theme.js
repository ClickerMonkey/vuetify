import { colorToInt, intToHex, colorToHex } from './colorUtils';
import * as sRGB from './color/transformSRGB';
import * as LAB from './color/transformCIELAB';
export function parse(theme, isItem = false) {
    const colors = Object.keys(theme);
    const parsedTheme = {};
    for (let i = 0; i < colors.length; ++i) {
        const name = colors[i];
        const value = theme[name];
        if (isItem) {
            if (name === 'base' || name.startsWith('lighten') || name.startsWith('darken')) {
                parsedTheme[name] = colorToHex(value);
            }
        }
        else if (typeof value === 'object') {
            parsedTheme[name] = parse(value, true);
        }
        else {
            parsedTheme[name] = genVariations(name, colorToInt(value));
        }
    }
    return parsedTheme;
}
/**
 * Generate the CSS for a base color (.primary)
 */
const genBaseColor = (name, value) => {
    return `
.${name} {
  background-color: ${value} !important;
  border-color: ${value} !important;
}
.${name}--text {
  color: ${value} !important;
}
.${name}--text input,
.${name}--text textarea {
  caret-color: ${value} !important;
}`;
};
/**
 * Generate the CSS for a variant color (.primary.darken-2)
 */
const genVariantColor = (name, variant, value) => {
    const [type, n] = variant.split(/(\d)/, 2);
    return `
.${name}.${type}-${n} {
  background-color: ${value} !important;
  border-color: ${value} !important;
}
.${name}--text.text--${type}-${n} {
  color: ${value} !important;
}
.${name}--text.text--${type}-${n} input,
.${name}--text.text--${type}-${n} textarea {
  caret-color: ${value} !important;
}`;
};
export function genStyles(theme) {
    const colors = Object.keys(theme);
    if (!colors.length)
        return '';
    let css = `a { color: ${theme.primary.base}; }`;
    for (let i = 0; i < colors.length; ++i) {
        const name = colors[i];
        const value = theme[name];
        if (typeof value === 'object') {
            css += genBaseColor(name, value.base);
            const variants = Object.keys(value);
            for (let i = 0; i < variants.length; ++i) {
                const variant = variants[i];
                const variantValue = value[variant];
                if (variant !== 'base') {
                    css += genVariantColor(name, variant, variantValue);
                }
            }
        }
    }
    return css;
}
export function genVariations(name, value) {
    const values = {
        base: intToHex(value)
    };
    for (let i = 5; i > 0; --i) {
        values[`lighten${i}`] = intToHex(lighten(value, i));
    }
    for (let i = 1; i <= 4; ++i) {
        values[`darken${i}`] = intToHex(darken(value, i));
    }
    return values;
}
function lighten(value, amount) {
    const lab = LAB.fromXYZ(sRGB.toXYZ(value));
    lab[0] = lab[0] + amount * 10;
    return sRGB.fromXYZ(LAB.toXYZ(lab));
}
function darken(value, amount) {
    const lab = LAB.fromXYZ(sRGB.toXYZ(value));
    lab[0] = lab[0] - amount * 10;
    return sRGB.fromXYZ(LAB.toXYZ(lab));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGhlbWUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdXRpbC90aGVtZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxVQUFVLEVBQU8sTUFBTSxjQUFjLENBQUE7QUFDcEUsT0FBTyxLQUFLLElBQUksTUFBTSx1QkFBdUIsQ0FBQTtBQUM3QyxPQUFPLEtBQUssR0FBRyxNQUFNLHlCQUF5QixDQUFBO0FBc0I5QyxNQUFNLFVBQVUsS0FBSyxDQUFFLEtBQXFELEVBQUUsTUFBTSxHQUFHLEtBQUs7SUFDMUYsTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQTtJQUNqQyxNQUFNLFdBQVcsR0FBUSxFQUFFLENBQUE7SUFFM0IsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLEVBQUU7UUFDdEMsTUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFBO1FBQ3RCLE1BQU0sS0FBSyxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQTtRQUV6QixJQUFJLE1BQU0sRUFBRTtZQUNWLElBQUksSUFBSSxLQUFLLE1BQU0sSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLEVBQUU7Z0JBQzlFLFdBQVcsQ0FBQyxJQUFJLENBQUMsR0FBRyxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUE7YUFDdEM7U0FDRjthQUFNLElBQUksT0FBTyxLQUFLLEtBQUssUUFBUSxFQUFFO1lBQ3BDLFdBQVcsQ0FBQyxJQUFJLENBQUMsR0FBRyxLQUFLLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFBO1NBQ3ZDO2FBQU07WUFDTCxXQUFXLENBQUMsSUFBSSxDQUFDLEdBQUcsYUFBYSxDQUFDLElB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QUFDLEVBQUUsRUFBRSxDQUFDLEVBQUU7UUFDM0IsTUFBTSxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFBO0tBQ2xEO0lBRUQsT0FBTyxNQUFNLENBQUE7QUFDZixDQUFDO0FBRUQsU0FBUyxPQUFPLENBQUUsS0FBVSxFQUFFLE1BQWM7SUFDMUMsTUFBTSxHQUFHLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUE7SUFDMUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxNQUFNLEdBQUcsRUFBRSxDQUFBO0lBQzdCLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUE7QUFDckMsQ0FBQztBQUVELFNBQVMsTUFBTSxDQUFFLEtBQVUsRUFBRSxNQUFjO0lBQ3pDLE1BQU0sR0FBRyxHQUFHLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFBO0lBQzFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsTUFBTSxHQUFHLEVBQUUsQ0FBQTtJQUM3QixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFBO0FBQ3JDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjb2xvclRvSW50LCBpbnRUb0hleCwgY29sb3JUb0hleCwgUkdCIH0gZnJvbSAnLi9jb2xvclV0aWxzJ1xuaW1wb3J0ICogYXMgc1JHQiBmcm9tICcuL2NvbG9yL3RyYW5zZm9ybVNSR0InXG5pbXBvcnQgKiBhcyBMQUIgZnJvbSAnLi9jb2xvci90cmFuc2Zvcm1DSUVMQUInXG5pbXBvcnQgeyBWdWV0aWZ5VGhlbWUgfSBmcm9tICd0eXBlcydcblxuaW50ZXJmYWNlIFBhcnNlZFRoZW1lSXRlbSB7XG4gIGJhc2U6IHN0cmluZ1xuICBsaWdodGVuNTogc3RyaW5nXG4gIGxpZ2h0ZW40OiBzdHJpbmdcbiAgbGlnaHRlbjM6IHN0cmluZ1xuICBsaWdodGVuMjogc3RyaW5nXG4gIGxpZ2h0ZW4xOiBzdHJpbmdcbiAgZGFya2VuMTogc3RyaW5nXG4gIGRhcmtlbjI6IHN0cmluZ1xuICBkYXJrZW4zOiBzdHJpbmdcbiAgZGFya2VuNDogc3RyaW5nXG5cbiAgW25hbWU6IHN0cmluZ106IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgUGFyc2VkVGhlbWUge1xuICBbbmFtZTogc3RyaW5nXTogUGFyc2VkVGhlbWVJdGVtXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZSAodGhlbWU6IFZ1ZXRpZnlUaGVtZSB8IFJlY29yZDxzdHJpbmcsIG51bWJlciB8IHN0cmluZz4sIGlzSXRlbSA9IGZhbHNlKTogUGFyc2VkVGhlbWUge1xuICBjb25zdCBjb2xvcnMgPSBPYmplY3Qua2V5cyh0aGVtZSlcbiAgY29uc3QgcGFyc2VkVGhlbWU6IGFueSA9IHt9XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb2xvcnMubGVuZ3RoOyArK2kpIHtcbiAgICBjb25zdCBuYW1lID0gY29sb3JzW2ldXG4gICAgY29uc3QgdmFsdWUgPSB0aGVtZVtuYW1lXVxuXG4gICAgaWYgKGlzSXRlbSkge1xuICAgICAgaWYgKG5hbWUgPT09ICdiYXNlJyB8fCBuYW1lLnN0YXJ0c1dpdGgoJ2xpZ2h0ZW4nKSB8fCBuYW1lLnN0YXJ0c1dpdGgoJ2RhcmtlbicpKSB7XG4gICAgICAgIHBhcnNlZFRoZW1lW25hbWVdID0gY29sb3JUb0hleCh2YWx1ZSlcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgIHBhcnNlZFRoZW1lW25hbWVdID0gcGFyc2UodmFsdWUsIHRydWUpXG4gICAgfSBlbHNlIHtcbiAgICAgIHBhcnNlZFRoZW1lW25hbWVdID0gZ2VuVmFyaWF0aW9ucyhuYW1lLCBjb2xvclRvSW50KHZhbHVlKSlcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcGFyc2VkVGhlbWVcbn1cblxuLyoqXG4gKiBHZW5lcmF0ZSB0aGUgQ1NTIGZvciBhIGJhc2UgY29sb3IgKC5wcmltYXJ5KVxuICovXG5jb25zdCBnZW5CYXNlQ29sb3IgPSAobmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgcmV0dXJuIGBcbi4ke25hbWV9IHtcbiAgYmFja2dyb3VuZC1jb2xvcjogJHt2YWx1ZX0gIWltcG9ydGFudDtcbiAgYm9yZGVyLWNvbG9yOiAke3ZhbHVlfSAhaW1wb3J0YW50O1xufVxuLiR7bmFtZX0tLXRleHQge1xuICBjb2xvcjogJHt2YWx1ZX0gIWltcG9ydGFudDtcbn1cbi4ke25hbWV9LS10ZXh0IGlucHV0LFxuLiR7bmFtZX0tLXRleHQgdGV4dGFyZWEge1xuICBjYXJldC1jb2xvcjogJHt2YWx1ZX0gIWltcG9ydGFudDtcbn1gXG59XG5cbi8qKlxuICogR2VuZXJhdGUgdGhlIENTUyBmb3IgYSB2YXJpYW50IGNvbG9yICgucHJpbWFyeS5kYXJrZW4tMilcbiAqL1xuY29uc3QgZ2VuVmFyaWFudENvbG9yID0gKG5hbWU6IHN0cmluZywgdmFyaWFudDogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgY29uc3QgW3R5cGUsIG5dID0gdmFyaWFudC5zcGxpdCgvKFxcZCkvLCAyKVxuICByZXR1cm4gYFxuLiR7bmFtZX0uJHt0eXBlfS0ke259IHtcbiAgYmFja2dyb3VuZC1jb2xvcjogJHt2YWx1ZX0gIWltcG9ydGFudDtcbiAgYm9yZGVyLWNvbG9yOiAke3ZhbHVlfSAhaW1wb3J0YW50O1xufVxuLiR7bmFtZX0tLXRleHQudGV4dC0tJHt0eXBlfS0ke259IHtcbiAgY29sb3I6ICR7dmFsdWV9ICFpbXBvcnRhbnQ7XG59XG4uJHtuYW1lfS0tdGV4dC50ZXh0LS0ke3R5cGV9LSR7bn0gaW5wdXQsXG4uJHtuYW1lfS0tdGV4dC50ZXh0LS0ke3R5cGV9LSR7bn0gdGV4dGFyZWEge1xuICBjYXJldC1jb2xvcjogJHt2YWx1ZX0gIWltcG9ydGFudDtcbn1gXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZW5TdHlsZXMgKHRoZW1lOiBQYXJzZWRUaGVtZSk6IHN0cmluZyB7XG4gIGNvbnN0IGNvbG9ycyA9IE9iamVjdC5rZXlzKHRoZW1lKVxuXG4gIGlmICghY29sb3JzLmxlbmd0aCkgcmV0dXJuICcnXG5cbiAgbGV0IGNzcyA9IGBhIHsgY29sb3I6ICR7dGhlbWUucHJpbWFyeS5iYXNlfTsgfWBcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbG9ycy5sZW5ndGg7ICsraSkge1xuICAgIGNvbnN0IG5hbWUgPSBjb2xvcnNbaV1cbiAgICBjb25zdCB2YWx1ZSA9IHRoZW1lW25hbWVdXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGNzcyArPSBnZW5CYXNlQ29sb3IobmFtZSwgdmFsdWUuYmFzZSlcblxuICAgICAgY29uc3QgdmFyaWFudHMgPSBPYmplY3Qua2V5cyh2YWx1ZSlcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmFyaWFudHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgY29uc3QgdmFyaWFudCA9IHZhcmlhbnRzW2ldXG4gICAgICAgIGNvbnN0IHZhcmlhbnRWYWx1ZSA9IHZhbHVlW3ZhcmlhbnRdXG4gICAgICAgIGlmICh2YXJpYW50ICE9PSAnYmFzZScpIHtcbiAgICAgICAgICBjc3MgKz0gZ2VuVmFyaWFudENvbG9yKG5hbWUsIHZhcmlhbnQsIHZhcmlhbnRWYWx1ZSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBjc3Ncbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdlblZhcmlhdGlvbnMgKG5hbWU6IHN0cmluZywgdmFsdWU6IFJHQik6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4ge1xuICBjb25zdCB2YWx1ZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgYmFzZTogaW50VG9IZXgodmFsdWUpXG4gIH1cblxuICBmb3IgKGxldCBpID0gNTsgaSA+IDA7IC0taSkge1xuICAgIHZhbHVlc1tgbGlnaHRlbiR7aX1gXSA9IGludFRvSGV4KGxpZ2h0ZW4odmFsdWUsIGkpKVxuICB9XG5cbiAgZm9yIChsZXQgaSA9IDE7IGkgPD0gNDsgKytpKSB7XG4gICAgdmFsdWVzW2BkYXJrZW4ke2l9YF0gPSBpbnRUb0hleChkYXJrZW4odmFsdWUsIGkpKVxuICB9XG5cbiAgcmV0dXJuIHZhbHVlc1xufVxuXG5mdW5jdGlvbiBsaWdodGVuICh2YWx1ZTogUkdCLCBhbW91bnQ6IG51bWJlcik6IFJHQiB7XG4gIGNvbnN0IGxhYiA9IExBQi5mcm9tWFlaKHNSR0IudG9YWVoodmFsdWUpKVxuICBsYWJbMF0gPSBsYWJbMF0gKyBhbW91bnQgKiAxMFxuICByZXR1cm4gc1JHQi5mcm9tWFlaKExBQi50b1hZWihsYWIpKVxufVxuXG5mdW5jdGlvbiBkYXJrZW4gKHZhbHVlOiBSR0IsIGFtb3VudDogbnVtYmVyKTogUkdCIHtcbiAgY29uc3QgbGFiID0gTEFCLmZyb21YWVooc1JHQi50b1hZWih2YWx1ZSkpXG4gIGxhYlswXSA9IGxhYlswXSAtIGFtb3VudCAqIDEwXG4gIHJldHVybiBzUkdCLmZyb21YWVooTEFCLnRvWFlaKGxhYikpXG59XG4iXX0=